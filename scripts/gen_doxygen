#!/bin/bash
# SPDX-License-Identifier: Apache-2.0
# (c) Copyright 2018 - 2022 Xilinx, Inc. All rights reserved.

export TS_TOPDIR="$(cd "$(dirname "$(which "$0")")"/.. ; pwd -P)"
pushd $TS_TOPDIR/nvmeof-ts

help() {
    cat <<EOF
This is a wrapper script which builds the autogenerated part of the
NVMe test suite documentation.

Usage:
  $ gen_doxygen

Documentation will be located at sockapi-ts/doc/html/
EOF

    exit 0
}

[ "x$1" = "x--help" ] || [ "x$1" = "x-h" ] && help

if test -z "${TE_BASE}" ; then
    echo "TE_BASE environment variable must be set" >&2
    exit 1
fi

doxygen
pushd $TS_TOPDIR
${TE_BASE}/doc/dox_resources/tableofcontents
popd

echo "" >&2
echo "###########################################" >&2
echo "## See nvmeof-ts/doc/html/index.html ######" >&2
echo "###########################################" >&2

popd
